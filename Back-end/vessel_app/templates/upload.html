{% if current_user.is_authenticated %}
{% extends "user_layout.html" %}
{% else %}
{% extends "layout.html" %}
{% endif %}
{% block content %}

{{ dropzone.load_css(css_url='/static/css/dropzone.css') }} 
{{ dropzone.style('border: 2px dashed #0087F7; margin: 10px 0 10px; min-height: 400px; width: 800px') }}
<div class="header-blue">
    <div class="container hero">
        <div class="content-section-upload">
            <fieldset class="form-group">   
                <div class="font_headers"> <!-- found in styles.css -->
                    <h2 > Drag or Drop DICOM   </h2>
                
                
                    {% with messages = get_flashed_messages() %}
                    {% if messages %}
                      
                      {% for message in messages %}
                        <h4 style="text-align: center; color:red;">{{ message }}</h4>
                      {% endfor %}
                      
                    {% endif %}
                  {% endwith %}
                
                </div>         
                
                <div class="center_dropbox"> <!-- found in styles.css -->
                    
               
                <form  
                id="myAwesomeDropzone"
                action="{{ url_for('handle_form') }}" 
                enctype="multipart/form-data" method="post">
                    <div class = "font_input"> <!-- found in styles.css -->
                        <label for="study_name">Study Name</label>
                        <input type="text" id="study_name" name="study_name" required/><br>
                        <label for="description">Description</label>
                        <input type="text" id="description" name="description" required/><br>
                           
                        <input type="submit" id="submit" value="Submit and Upload">
                        
                        <div style="margin-top:5%;" class="progress">
                            <div class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width:0%">
                                <span class="the-progress-text"></span>
                            </div>
                        </div>

                                {{ dropzone.create() }} <!-- this makes the class dropzone dropzone.css -->
                             
                      
                    </div>
                </div>
                </form>

                

                {{ dropzone.load_js() }}
                {{ dropzone.config(custom_options='
                autoProcessQueue: false, 
                addRemoveLinks: true, 
                parallelUploads: 200, 
                uploadMultiple: true,
                
                ' ) }}
            </fieldset>
        </div>
    </div>  
</div>

<script>

Dropzone.autoDiscover = false;

$(function() {
  // Now that the DOM is fully loaded, create the dropzone, and setup the
  // event listeners
  var myDropzone = new Dropzone("#myDropzone");
  myDropzone.on("addedfile", function(file) {
    /* Maybe display some more file information on your page */
  
     console.log("HELLO");

  });
  myDropzone.on("uploadprogress", function(file, progress, bytesSent) {
    /* Maybe display some more file information on your page */
  
 //    console.log("uploading " + progress);


  });

  myDropzone.on("totaluploadprogress", function (progress) {
    console.log( progress);
    $(".progress-bar").width(progress + '%'); // div tags
    $(".the-progress-text").text(Math.round(progress) + '%'); // span

});

myDropzone.on("processingmultiple", function (progress) {
    console.log( progress);
    
});




})

$(document).ready(function () {

$('#myAwesomeDropzone').validate({
    rules: {
        Study_Name: {
            required: true
        },
        description: {
            required: true
        }
    }
});

});


    /*
document.getElementById("#upload_form").dropzone({
   
    processingmultiple() {},
    sending() {},
    totaluploadprogress(uploadProgress) {},
    successmultiple(files, res) {},
    errormultiple(file, res, xhr) {},
    queuecomplete() {}
})

myDropzone.on("totaluploadprogress", function (progress) {
  $("#the-progress-div").width(progress + '%');
  $(".the-progress-text").text(progress + '%');
});
 
 myDropzone.on("totaluploadprogress", function (progress) {
  $("#the-progress-div").width(progress + '%');
  $(".the-progress-text").text(progress + '%');
});*/
</script>
{% endblock content %}