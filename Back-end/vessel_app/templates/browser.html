{% if current_user.is_authenticated %}
{% extends "user_layout.html" %}
{% else %}
{% extends "layout.html" %}
{% endif %}

{% block content %}

<div class='browser' style='display: grid; grid-template-columns: auto;'>
    {% if all_studies == [] %}
        <div class='card' style='margin: 3%; background: whitesmoke;'>
            <div class='container'>
                    <div class="browser_card">
                        <p>You have no files uploaded. Please go to the <a href=' {{url_for("upload")}} '>upload page</a> to continue.</p>
                    </div>
            </div>
    {% else %}
        </div>
        {% for study in all_studies %}
        <div class='card' style='margin: 3%; background: whitesmoke;'>
            <div class='container'>
                <table> 
                    <tr>
                        <td> 
                            <img src="{{ url_for('static', filename=study[1]) }}" alt="text">    
                        </td>
                    </tr>
                </table>
                <table style="border-spacing: 50px 50px;">
                <tr style="text-align: center;">
                    <strong>
                    {% for field in browserFields %}
                        <th> {{ field }}   </th>    
                    {% endfor %}
                        <th> File Count </th>
                    </strong>
                </tr>
                <tr style="text-align: center;">
                    {% for field in browserFields %}   
                        {% if field in study[0] %}
                            <td>  {{ study[0][field].iloc[0].value.decode("utf-8") }} </td>
                        {% else %}
                            <td> NO DATA </td>
                        {% endif %}
                    {% endfor %}
                    <td> {{ study[2] }} </td>
                </tr>
                </table> 
                <table> 
                    <a href="{{url_for('job', session_id=study[3]) }}"> 
                    <button class="btn btn-success">  Process </button> </a>
                </table>
                <table> 
                    <a href="{{url_for('dicom_viewer', session_id=study[3]) }}"> 
                    <button class="btn btn-success">  DICOM Viewer </button> </a>
                </table>
            </div>  <!--- container options-->
        </div>
        {% endfor %}
    {% endif %}
</div>

{% endblock content %}